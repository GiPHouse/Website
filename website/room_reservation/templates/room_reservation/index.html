{% extends 'base.html' %}
{% load bootstrap4 %}

{% block content %}
<a href="{% url 'room_reservation:create_reservation' %}"><button class="btn btn-success mb-2">Make Reservation</button></a>

{% buttons %}
<a href="{% url 'room_reservation:calendar' %}?week={{ current_week|add:"-1"}}" ><button class="btn btn-secondary">Prev</button></a>
<a href="{% url 'room_reservation:calendar' %}?week={{ current_week|add:"1"}}" ><button class="btn btn-secondary">Next</button></a>
{% endbuttons %}
<h2>Week {{current_week}}</h2>
{% for room, reservations in this_weeks_reservations.items %}
	<h3>{{room}}</h3>
	<table class="table">
		<thead>
			<tr>
				<th scope="col"></th>
				<th scope="col">Mon</th> 
				<th scope="col">Tue</th> 
				<th scope="col">Wed</th> 
				<th scope="col">Thu</th> 
				<th scope="col">Fri</th> 
				<th scope="col">Sat</th> 
				<th scope="col">Sun</th> 
			</tr>
		</thead>
		<tbody>
			<tr>
				<td class="rr-calendar-times">
					<div class="rr-calendar-day">
					<div class="rr-calendar-hour" style="top: calc(( 8 - 8)/10 * 100%);" > 8:00</div>
					<div class="rr-calendar-hour" style="top: calc((10 - 8)/10 * 100%);" >10:00</div>
					<div class="rr-calendar-hour" style="top: calc((12 - 8)/10 * 100%);" >12:00</div>
					<div class="rr-calendar-hour" style="top: calc((14 - 8)/10 * 100%);" >14:00</div>
					<div class="rr-calendar-hour" style="top: calc((16 - 8)/10 * 100%);" >16:00</div>
					<div class="rr-calendar-hour" style="top: calc((18 - 8)/10 * 100%);" >18:00</div>
					</div>
				</td>
			{% for col in reservations %}
				<td>
					<div class="rr-calendar-day" >
				{% for r in col %}
				<div class="rr-calendar-reservation" 
					style="top: calc( ({{r.start_time|date:"H"}} - 8) / 10 * 100%); 
					height: calc( (({{r.end_time|date:"H"}} + {{r.end_time|date:"i"}} / 60) - 8 ) / 10 * 100% - (({{r.start_time|date:"H"}} + {{r.start_time|date:"i"}} / 60) - 8) / 10 * 100%); "
					>
					<p>{{r.reservee}}<br/> 
					({{r.start_time|date:"H:i"}}-{{r.end_time|date:"H:i"}})
					</p>
					{% if r.reservee == request.user %}
					<div class="rr-reservation-actions">
						<a href ="{% url 'room_reservation:delete_reservation' r.pk %}" ><button class="btn btn-danger btn-sm">X</button></a>
						<a href ="{% url 'room_reservation:update_reservation' r.pk %}" ><button class="btn btn-info btn-sm">Change</button></a>
					</div>
					{% endif %}
					</div>
				{% endfor %}
					</div>
				</td>
			{% endfor %}
			</tr>
		</tbody>
	</table>
{% endfor %}

{% endblock %}
